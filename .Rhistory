knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(coin)
library(broom)
lfs_toronto = read_csv("data/LFS_Toronto.csv")
# joblessness of Unemployed individuals by education tiers
# lfs_toronto %>%
#   filter(lfsstat %in% 3 & educ %in% 2:6 & !is.na(durunemp)) %>%
#   mutate(educ = factor(educ)) %>%
#   group_by(educ) %>%
#   select(educ, durunemp) %>%
#   mutate(durunemp_in_years = round(durunemp/52)) %>% #since Duration of unemployment in weeks
#   count(durunemp_in_years) %>%
#   arrange(desc(durunemp_in_years)) %>%
#   mutate(durunemp_in_years = factor(durunemp_in_years)) %>%
#   mutate(number_of_individuals = n) %>%
#   ggplot(aes(x=durunemp_in_years, y=number_of_individuals, fill = durunemp_in_years))+
#   geom_bar(stat = "identity")+
#   facet_wrap(facets = ~educ)+
#   ggtitle("Duration of Unemployment for different Education levels")
# lfs_toronto %>%
#   filter(educ %in% 2:6, lfsstat == 3) %>% # lfsstat == 3  unemployed
#   mutate(educ = factor(educ)) %>%
#   select(CASEID, educ) %>%
#   group_by(educ) %>%
#   count(educ) %>%
#   transmute(individuals_unemployed = n)
toronto_unemplrate = lfs_toronto %>%
summarise(UNEMPL = sum(lfsstat == 3)/sum(lfsstat!=4)) %>% pull()
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(UNEMPLrate = sum(lfsstat == 3)/sum(lfsstat != 4)) %>%
arrange(UNEMPLrate) %>%
mutate(diff_from_TorontoAggregate = UNEMPLrate - toronto_unemplrate)
lfs_toronto %>%
filter(lfsstat %in% c(1,3) & educ %in% 2:6) %>%
mutate(educ = factor(educ)) %>%
independence_test( lfsstat ~ educ, data = ., distribution = "approx" )
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")
# Does educ level affect unemployment significantly in any regard
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 4:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 5 and 6
# 5: University: bachelors degree
# 6: University: graduate degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(5,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 4 and 5
# 4: Post secondary certificate or diploma
# 5: University: bachelors degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,5)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 4 and 6
# 4: Post secondary certificate or diploma
# 6: University: graduate degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(flowunem ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), empl = (lfsstat != 3)) %>%
aov(empl ~ educ, data=.)
TukeyHSD(lfs.aov)
(toronto_emplrate = lfs_toronto %>%
summarise(EMPL = sum(lfsstat %in% c(1,2))/sum(lfsstat!=4)) %>% pull())
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(EMPLrate = sum(lfsstat %in% c(1,2))/sum(lfsstat != 4)) %>%
arrange(EMPLrate) %>%
mutate(diff_from_aggregate = EMPLrate - toronto_emplrate)
## echo=FALSE stops the code chunk from appearing in the html document
## warning=FALSE / message=FALSE stop R warnings/messages from appearing in the knit document
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(stringr)
library(ggplot2)
timeToAmortize <- function(yearEarning, tuition){
time = (tuition*4)/yearEarning
return(time)
}
# loading data sets
canUndergrad = read_csv("data/can-undergrad.csv")
canGrad = read_csv("data/can-grad.csv")
interUndergrad = read_csv("data/inter-undergrad.csv")
interGrad = read_csv("data/inter-grad.csv")
income = read_csv("data/income6.csv")
income = group_by(income, CorrespondingTo) %>% summarise(avgIncome = mean(`Average after-tax income ($)`)) %>% rename(Field_of_study = 'CorrespondingTo')
mostWorthIt <- function(dat){
dat = dat %>% rename(y1 = '2014-2015', y2 = '2015-2016', y3 = '2016-2017', y4 = '2017-2018', y5 = '2018-2019') %>% mutate(avgTuition = (`y1` + `y2` + `y3` + `y4` + `y5`)/5) %>% right_join(income, by = "Field_of_study") %>% mutate(amortizeTime = timeToAmortize(avgIncome, avgTuition)) %>% arrange(amortizeTime) %>% head(1)
return(dat)
}
leastWorthIt <- function(dat){
dat = dat %>% rename(y1 = '2014-2015', y2 = '2015-2016', y3 = '2016-2017', y4 = '2017-2018', y5 = '2018-2019') %>% mutate(avgTuition = (`y1` + `y2` + `y3` + `y4` + `y5`)/5) %>% right_join(income, by = "Field_of_study") %>% mutate(amortizeTime = timeToAmortize(avgIncome, avgTuition)) %>% arrange(desc(amortizeTime)) %>% head(1)
return(dat)
}
leastWorthIt(canUndergrad)
leastWorthIt(interUndergrad)
leastWorthIt(canGrad)
leastWorthIt(interGrad)
## echo=FALSE stops the code chunk from appearing in the html document
## warning=FALSE / message=FALSE stop R warnings/messages from appearing in the knit document
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(stringr)
library(ggplot2)
domestic_undergraduate =
univcan_data %>%
mutate(domestic_undergraduate_tuition = str_extract(Undergraduate, "(\\d+)[^-*]*$")) %>%
select(University, Province, domestic_undergraduate_tuition) %>%
filter(Province == "Ontario") %>% na.omit()
## echo=FALSE stops the code chunk from appearing in the html document
## warning=FALSE / message=FALSE stop R warnings/messages from appearing in the knit document
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(stringr)
library(ggplot2)
domestic_undergraduate =
univcan_data %>%
mutate(domestic_undergraduate_tuition = str_extract(Undergraduate, "(\\d+)[^-*]*$")) %>%
select(University, Province, domestic_undergraduate_tuition) %>%
filter(Province == "Ontario") %>% na.omit()
domestic_undergraduate =
univcan_data %>%
mutate(domestic_undergraduate_tuition = str_extract(Undergraduate, "(\\d+)[^-*]*$")) %>%
select(University, Province, domestic_undergraduate_tuition) %>%
filter(Province == "Ontario") %>% na.omit()
lfs_toronto = read_csv("data/LFS_Toronto.csv")
## echo=FALSE stops the code chunk from appearing in the html document
## warning=FALSE / message=FALSE stop R warnings/messages from appearing in the knit document
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(coin)
library(broom)
lfs_toronto = read_csv("data/LFS_Toronto.csv")
# joblessness of Unemployed individuals by education tiers
# lfs_toronto %>%
#   filter(lfsstat %in% 3 & educ %in% 2:6 & !is.na(durunemp)) %>%
#   mutate(educ = factor(educ)) %>%
#   group_by(educ) %>%
#   select(educ, durunemp) %>%
#   mutate(durunemp_in_years = round(durunemp/52)) %>% #since Duration of unemployment in weeks
#   count(durunemp_in_years) %>%
#   arrange(desc(durunemp_in_years)) %>%
#   mutate(durunemp_in_years = factor(durunemp_in_years)) %>%
#   mutate(number_of_individuals = n) %>%
#   ggplot(aes(x=durunemp_in_years, y=number_of_individuals, fill = durunemp_in_years))+
#   geom_bar(stat = "identity")+
#   facet_wrap(facets = ~educ)+
#   ggtitle("Duration of Unemployment for different Education levels")
# lfs_toronto %>%
#   filter(educ %in% 2:6, lfsstat == 3) %>% # lfsstat == 3  unemployed
#   mutate(educ = factor(educ)) %>%
#   select(CASEID, educ) %>%
#   group_by(educ) %>%
#   count(educ) %>%
#   transmute(individuals_unemployed = n)
toronto_unemplrate = lfs_toronto %>%
summarise(UNEMPL = sum(lfsstat == 3)/sum(lfsstat!=4)) %>% pull()
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(UNEMPLrate = sum(lfsstat == 3)/sum(lfsstat != 4)) %>%
arrange(UNEMPLrate) %>%
mutate(diff_from_TorontoAggregate = UNEMPLrate - toronto_unemplrate)
lfs_toronto %>%
filter(lfsstat %in% c(1,3) & educ %in% 2:6) %>%
mutate(educ = factor(educ)) %>%
independence_test( lfsstat ~ educ, data = ., distribution = "approx" )
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")
# Does educ level affect unemployment significantly in any regard
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 4:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 5 and 6
# 5: University: bachelors degree
# 6: University: graduate degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(5,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 4 and 5
# 4: Post secondary certificate or diploma
# 5: University: bachelors degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,5)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
# Is there a statistically significant difference in affect on
# unemployment between educ level 4 and 6
# 4: Post secondary certificate or diploma
# 6: University: graduate degree
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(flowunem ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), empl = (lfsstat != 3)) %>%
aov(empl ~ educ, data=.)
TukeyHSD(lfs.aov)
(toronto_emplrate = lfs_toronto %>%
summarise(EMPL = sum(lfsstat %in% c(1,2))/sum(lfsstat!=4)) %>% pull())
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(EMPLrate = sum(lfsstat %in% c(1,2))/sum(lfsstat != 4)) %>%
arrange(EMPLrate) %>%
mutate(diff_from_aggregate = EMPLrate - toronto_emplrate)
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 4:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(5,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,5)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(4,5)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(flowunem ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), empl = (lfsstat != 3)) %>%
aov(empl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(unempl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), empl = (lfsstat != 3)) %>%
aov(empl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(unempl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), empl = (lfsstat != 3)) %>%
aov(empl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs.aov=lfs_toronto %>%
filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
aov(unempl ~ educ, data=.)
TukeyHSD(lfs.aov)
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
limits = c("2_","3_","4_","5_","6_"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
limits = c("2","3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
limits = c("Gr 11 to 13, graduate",
"3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill", stat = "identity")+
scale_x_discrete(name="Educational attainment",
limits = c("Gr 11 to 13, graduate",
"3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, y=unempl, fill=unempl))+
geom_bar(position = "fill", stat = "identity")+
scale_x_discrete(name="Educational attainment",
limits = c("Gr 11 to 13, graduate",
"3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill", stat = "identity")+
scale_x_discrete(name="Educational attainment",
limits = c("2",
"3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
limits = c("2",
"3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
labels = c("2","3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
labels = c("Gr 11 to 13, graduate","3","4","5","6"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
labels = c("Gr 11 to 13, graduate",
"Some post secondary",
"Post secondary certificate/diploma",
"University:Bachelors degree",
"University:Graduate degree"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
scale_x_discrete(name="Educational attainment",
labels = c("Gr 11 to 13, graduate",
"Some post secondary",
"Post secondary certificate/diploma",
"University:Bachelors degree",
"University:Graduate degree"))+
theme(axis.text.x = element_text(angle = 45))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
theme(axis.text.x = element_text(angle = 45))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployment Status")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_x_discrete("Educational levels",
values = educ)
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_x_discrete("Educational levels")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_x_discrete("Educational levels",
guide = guide_legend(override.aes = list(fill=NA)))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_x_discrete("Educational levels",
values = educ,
guide = guide_legend(override.aes = list(fill=NA)))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_fill_discrete("blah blah",
labels = c("23","33","34","35","43"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")+
scale_x_discrete("blah blah",
labels = c("23","33","34","35","43"))
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")
lfs_toronto %>% filter(lfsstat !=4 & educ %in% 2:6) %>%
mutate(educ = factor(educ), unempl = (lfsstat == 3)) %>%
ggplot(aes(x=educ, fill=unempl))+
geom_bar(position = "fill")+
xlab("Educational attainment")+
labs(fill="Unemployed")
(toronto_unemplrate = lfs_toronto %>%
summarise(UNEMPL = sum(lfsstat == 3)/sum(lfsstat!=4)) %>% pull())
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(UNEMPLrate = sum(lfsstat == 3)/sum(lfsstat != 4)) %>%
arrange(UNEMPLrate) %>%
mutate(Difference_from_Toronto_rate = UNEMPLrate - toronto_unemplrate)
(toronto_unemplrate = lfs_toronto %>%
summarise(UNEMPL = sum(lfsstat == 3)/sum(lfsstat!=4)) %>% pull())
lfs_toronto %>%
filter(educ %in% 2:6) %>% # lfsstat == 3  unemployed
mutate(educ = factor(educ)) %>%
group_by(educ) %>%
summarise(UNEMPLrate = sum(lfsstat == 3)/sum(lfsstat != 4)) %>%
arrange(UNEMPLrate) %>%
mutate(Difference_from_Toronto_UNEMPLrate = UNEMPLrate - toronto_unemplrate)
lfs_toronto %>% filter(lfsstat !=4 & educ %in% c(5,6)) %>%
mutate(educ = factor(educ), unempl = factor(lfsstat == 3)) %>%
chisq_test(unempl ~ educ, data = .,
distribution = "approx")
